<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="msapplication-tap-highlight" content="no">
    <meta name="description" content="">
    <title>Documentation - Materialize</title>
    <!-- Favicons-->
    <link rel="apple-touch-icon-precomposed" href="images/favicon/logo_web.ico">
    <meta name="msapplication-TileColor" content="#FFFFFF">
    <meta name="msapplication-TileImage" content="images/favicon/mstile-144x144.png">
    <link rel="icon" href="images/favicon/logo_web.ico" sizes="32x32">
    <!--  Android 5 Chrome Color-->
    <meta name="theme-color" content="#EE6E73">
    <!-- CSS-->
    
    <link href="css/ghpages-materialize.css" type="text/css" rel="stylesheet" media="screen,projection">
    <link href="css/google_font.css" type="text/css" rel="stylesheet" media="screen,projection">
    <link href="css/font-awesome.css" rel="stylesheet" type="text/css">
  </head>
  <body>
    <header>
      <div class="container">
      <a href="#" data-activates="nav-mobile" class="button-collapse top-nav waves-effect waves-light circle hide-on-large-only">
      <i class="fa fa-bars" id="menu"></i></a></div>
      <ul id="nav-mobile" class="side-nav fixed">
      </ul>
    </header>
    <main>      
    <div class="section no-pad-bot" id="index-banner" style="height: 50px;">
        <div class="container"></div>
    </div>
    <div class="divider"></div>
        <div class="section">
          <div class="row center" id="badan">
             <div class="col s12 m2">
               <p class="z-depth-1"> 
                    <h3 class="light" style="font-family:Verdana, Geneva, sans-serif">Edit Register</h3>
               </p>
             </div>
             <div class="col s12">

             <h5 align="center"></h5>
                 <ul class="collapsible" id="tbl_form_2" style="margin-bottom:15px;">
                 </ul>
            </div>     
            <div id="btn-add" style="float:left; margin-top:20px; margin-bottom:20px; margin-left:10px;">
              <!--  <a class="btn-floating btn-large red add">
                    <i class="material-icons" id="add" data-id="add">+</i>
               </a> -->
            </div>
            <div id="hideForm" >  
              <form id="pendaftaran" method="post" enctype="multipart/form-data"> 
                <input id="id_edit" name="id_edit" value="0" type="hidden">       
                <div class="row">
                  <div class="input-field col s12">
                    <hr style="margin-bottom:10px; margin-top:10px;"> 
                  </div> 
                  <div class="input-field col s12">
                    <input id="emails" name="email" type="text" readonly>
                    <div id="info"></div>
                    <label for="disabled">email</label>
                  </div>
                  <!-- <div class="input-field col s12">
                      <input id="password" name="password" type="text">
                      <label for="icon_prefix">password</label>
                  </div>   -->  
                  <div class="input-field col s12">
                      <input class="materialize-input" name="fullname" type="text"  id="fullname">
                      <label for="icon_prefix" class="active">fullname</label>
                  </div> 
                  <div class="input-field col s12">
                      <div class="file-field input-field">
                        <div class="btn">
                          <span>File</span>
                          <input type="file" name="gambar">
                        </div>
                        <div class="file-path-wrapper">
                          <input class="file-path validate" type="text">
                          <img src="" width="75" id="findimg">
                        </div>
                      </div>
                  </div> 
                  <div class="input-field col s12">
                      <input id="idsosmed" name="idsosmed" type="text">
                      <label for="icon_prefix" class="active">Social ID</label>
                  </div>  
                  <div class="input-field col s12">
                    <select name="sosialmedia" id="sosialmedia" class="browser-default">
                   
                      <option value="FACEBOOK">FACEBOOK</option>
                      <option value="TWITTER">TWITTER</option>
                      <option value="APPLE">APPLE</option>
                      <option value="GOOGLE">GOOGLE</option>
                    </select>
                    <label class="active">Sosial Media</label>
                  </div>
                </div>
                 <input type="submit" class="btn purple" id="simpan_data" value=" Submit">
        <!--end row-->
              </form>
            </div>
       <!--end hideForm-->
     </div>
</div>
</main> 
<footer class="page-footer">
  <div class="container">
    <div class="row">
      <div class="col l6 s12">
        <h5 class="white-text"></h5>
        <p class="grey-text text-lighten-4"></p>
      </div>
      <div class="col l4 offset-l2 s12">
        <h5 class="white-text">Links</h5>
        <ul  style="color:#FFF;">
          
        </ul>
      </div>
    </div>
  </div>
  <div class="footer-copyright">
    <div class="container">
    Â© Copyright 2020
    </div>
  </div>
</footer>

  
    <!--  Scripts-->
<script src="js/jquery-2.1.4.min.js"></script>
<script src="js/jquery.timeago.min.js"></script>
<script src="js/prism.js"></script>
<script src="js/lunr.min.js"></script>
<script src="bin/materialize.js"></script>
<script src="js/init.js"></script>
<!-- <script src="js/index_html.js" type="text/javascript"></script> -->
 <script src="js/aksesoris.js"></script>
<script>
$(document).ready(function(e) { 
var email = window.location.search.substring(1); 
$("input#emails").val(email);
var loadingcss = '<div class="modal-overlay" style="margin-top: 30%"><div class="preloader-wrapper big active">'+
                        '<div class="spinner-layer spinner-blue-only">'+
                          '<div class="circle-clipper left">'+
                            '<div class="circle"></div>'+
                          '</div><div class="gap-patch">'+
                            '<div class="circle"></div>'+
                          '</div><div class="circle-clipper right">'+
                            '<div class="circle"></div>'+
                          '</div>'+
                        '</div>'+
                      '</div></div>';
//--cari data resultOne[i].judul
$.ajax({
    type: 'POST',
    url: getUrl('login/get_profile'),
    data: 'user='+email,
    //async: true,
    crossDomain: true,
    beforeSend: function(xhr){
        xhr.withCredentials = true;
    },
    success: function (data) {
        console.log(data);
        var resultOne = eval('(' + data + ')');
        if(data.length >0){
           for(var i=0;i<resultOne.length;i++)
               {
                //id_edit
                if(localStorage.getItem('id_edit') === null || localStorage.getItem('id_edit') == ''){
                   var id_edit      = localStorage.setItem('id_edit', resultOne[i].id_edit);
                   var email        = localStorage.setItem('email', resultOne[i].email);
                   var fullname     = localStorage.setItem('fullname', resultOne[i].fullname);
                   var idsosmed     = localStorage.setItem('social_id', resultOne[i].social_id);
                   var social_media = localStorage.setItem('social_media', resultOne[i].social_media);
                   var avatar       = localStorage.setItem('avatar', resultOne[i].avatar);
                   localStorage.setItem('saveObject', JSON.stringify(data));
                   //var retrievedObject = localStorage.getItem('saveObject');
                 }
                
                
                $("input#id_edit").val(resultOne[i].id_edit);
                $("input#fullname").val(resultOne[i].fullname);
                $("input#idsosmed").val(resultOne[i].social_id);
                $("input#social_media").val(resultOne[i].social_media);
                $("img#findimg").attr("src",getUrl('foto/thumb/')+resultOne[i].avatar);
                $("select#sosialmedia option[value='"+resultOne[i].social_media+"']").attr("selected","selected");
               }
        }
   }
});                                 
// set local storage seasion -------------------------------------------------------
$("body").on('click','div#btn-add', function(){
    var id = $("#add").attr("data-id");
    if(id == 'add'){
        $("#add").removeAttr("data-id");
        $("#add").html("-");
        $("#hideForm").show(900);
        $("#add").attr("data-id","min");    
    }else{
        $("#add").removeAttr("data-id");
        $("#add").html("+");
        $("#hideForm").hide(900);
        $("#add").attr("data-id","add");
    }
});
//Submit form
$('body').on('submit','#pendaftaran',function(event){
    event.preventDefault();
    var formData = new FormData($(this)[0]);
    var loadingcss = '<div class="modal-overlay" style="margin-top: 30%"><div class="preloader-wrapper big active">'+
                        '<div class="spinner-layer spinner-blue-only">'+
                          '<div class="circle-clipper left">'+
                            '<div class="circle"></div>'+
                          '</div><div class="gap-patch">'+
                            '<div class="circle"></div>'+
                          '</div><div class="circle-clipper right">'+
                            '<div class="circle"></div>'+
                          '</div>'+
                        '</div>'+
                      '</div></div>';
                $("i#snd").html("Loading proses....");
                $("div#badan").html("");
                $("div#badan").html(loadingcss);
                $.ajax({
                    type: 'POST',
                    url: getUrl('login/insert_data_register'),
                    data: formData,
                     contentType: false,
                     processData: false,
                    crossDomain: true,
                    beforeSend: function(xhr){
                        xhr.withCredentials = true;
                    },
                    success: function (data) {
                      console.log(data);
                        alert('Register Berhasil');
                        window.location.href = "edit.html?"+email;
                   }               
                });
          
    });
});
</script>
 
  </body>
</html>